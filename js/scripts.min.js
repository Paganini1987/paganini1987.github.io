document.addEventListener("DOMContentLoaded",function(){var e=[].slice.call(document.querySelectorAll("img.lazy")),t=[].slice.call(document.querySelectorAll(".lazy-background")),n=[].slice.call(document.querySelectorAll("[data-bg]"));if("IntersectionObserver"in window){let r=new IntersectionObserver(function(e,t){e.forEach(function(e){if(e.isIntersecting){let t=e.target;t.src=t.dataset.src,t.srcset=t.dataset.srcset,t.classList.remove("lazy"),r.unobserve(t)}})});e.forEach(function(e){r.observe(e)});let a=new IntersectionObserver(function(e,t){e.forEach(function(e){e.isIntersecting&&(e.target.classList.add("visible"),a.unobserve(e.target))})});t.forEach(function(e){a.observe(e)});let o=new IntersectionObserver(function(e,t){e.forEach(function(e){if(e.isIntersecting){let t=e.target;t.style.backgroundImage="url("+t.dataset.bg+")",o.unobserve(t)}})});n.forEach(function(e){o.observe(e)})}else e.forEach(function(e){e.src=e.dataset.src,e.srcset=e.dataset.srcset}),t.forEach(function(e){e.classList.add("visible")}),n.forEach(function(e){e.style.backgroundImage="url("+e.dataset.bg+")"})}),document.addEventListener("DOMContentLoaded",function(){var e,t,n=document.getElementById("canvas"),r=document.getElementById("canvas2"),a=document.querySelector("#canvas3"),o=n.getContext("2d"),c=r.getContext("2d"),i=a.getContext("2d"),d=window.innerWidth,s=window.innerHeight,l=document.querySelector("#video"),u=document.querySelector(".video"),g=new Image,v=new Image;function h(){return c.clearRect(0,0,d,s),c.drawImage(v,0,0,d,s),c.getImageData(0,0,d,s)}function m(){for(var n=function(){i.drawImage(l,0,0,e,t);var n=.1*e,r=.1*t,a=e/2-n/2,o=t/2-r/2;return i.getImageData(a+5,o+5,n-5,r-5)}(),r={red:[],green:[],blue:[]},a=0;a<n.data.length;a+=4){let e=n.data[a],t=n.data[a+1],o=n.data[a+2];r.red.push(e),r.green.push(t),r.blue.push(o)}let o=r.red.length,c=r.red.reduce((e,t)=>e+t)/o,d=r.green.reduce((e,t)=>e+t)/o,s=r.blue.reduce((e,t)=>e+t)/o;var u,g,v;u=c,g=d,v=s,document.querySelector(".js-set-color").style.backgroundColor="rgb("+u+","+g+","+v+")"}g.src="/img/@2x/209.jpg",v.src="/img/@2x/209.png",n.width=d,n.height=s,r.width=d,r.height=s,g.onload=function(){o.drawImage(g,0,0,d,s)},v.onload=function(){h()},window.addEventListener("resize",function(){d=window.innerWidth,s=window.innerHeight,n.width=d,n.height=s,r.width=d,r.height=s,o.clearRect(0,0,d,s),o.drawImage(g,0,0,d,s),h()}),document.getElementById("color").addEventListener("change",function(e){var t=e.target.value.match(/[A-Za-z0-9]{2}/g);!function([e,t,n]){let r=h();for(var a=0;a<r.data.length;a+=4){let o=r.data[a],c=r.data[a+1],i=r.data[a+2],d=(r.data[a+3],(o+c+i)/3/255);r.data[a]=e*d,r.data[a+1]=t*d,r.data[a+2]=n*d}c.putImageData(r,0,0)}(t=t.map(function(e){return parseInt(e,16)}))}),e=u.clientWidth,t=u.clientHeight,a.width=e,a.height=t,function e(){m(),requestAnimationFrame(e)}(),document.querySelector(".js-capture").addEventListener("click",m)});const videoElement=document.querySelector("video"),videoSelect=document.querySelector("select#videoSource"),selectors=[videoSelect];function gotDevices(e){const t=selectors.map(e=>e.value);selectors.forEach(e=>{for(;e.firstChild;)e.removeChild(e.firstChild)});for(let t=0;t!==e.length;++t){const n=e[t],r=document.createElement("option");r.value=n.deviceId,"videoinput"===n.kind?(r.text=n.label||`camera ${videoSelect.length+1}`,videoSelect.appendChild(r)):console.log("Some other kind of source/device: ",n)}selectors.forEach((e,n)=>{Array.prototype.slice.call(e.childNodes).some(e=>e.value===t[n])&&(e.value=t[n])})}function gotStream(e){return window.stream=e,videoElement.srcObject=e,navigator.mediaDevices.enumerateDevices()}function handleError(e){console.log("navigator.MediaDevices.getUserMedia error: ",e.message,e.name)}function start(){window.stream&&window.stream.getTracks().forEach(e=>{e.stop()});const e=videoSelect.value,t={video:{deviceId:e?{exact:e}:void 0}};navigator.mediaDevices.getUserMedia(t).then(gotStream).then(gotDevices).catch(handleError)}navigator.mediaDevices.enumerateDevices().then(gotDevices).catch(handleError),videoSelect.onchange=start,start();
document.addEventListener("DOMContentLoaded",function(){var e=[].slice.call(document.querySelectorAll("img.lazy")),t=[].slice.call(document.querySelectorAll(".lazy-background")),n=[].slice.call(document.querySelectorAll("[data-bg]"));if("IntersectionObserver"in window){let r=new IntersectionObserver(function(e,t){e.forEach(function(e){if(e.isIntersecting){let t=e.target;t.src=t.dataset.src,t.srcset=t.dataset.srcset,t.classList.remove("lazy"),r.unobserve(t)}})});e.forEach(function(e){r.observe(e)});let o=new IntersectionObserver(function(e,t){e.forEach(function(e){e.isIntersecting&&(e.target.classList.add("visible"),o.unobserve(e.target))})});t.forEach(function(e){o.observe(e)});let a=new IntersectionObserver(function(e,t){e.forEach(function(e){if(e.isIntersecting){let t=e.target;t.style.backgroundImage="url("+t.dataset.bg+")",a.unobserve(t)}})});n.forEach(function(e){a.observe(e)})}else e.forEach(function(e){e.src=e.dataset.src,e.srcset=e.dataset.srcset}),t.forEach(function(e){e.classList.add("visible")}),n.forEach(function(e){e.style.backgroundImage="url("+e.dataset.bg+")"})}),document.addEventListener("DOMContentLoaded",function(){var e,t,n,r,o,a=document.getElementById("canvas"),c=document.getElementById("canvas2"),i=document.querySelector("#canvas3"),d=a.getContext("2d"),s=c.getContext("2d"),l=i.getContext("2d"),u=window.innerWidth,g=window.innerHeight,v=document.querySelector("#video"),m=document.querySelector(".video"),h=document.querySelector(".wrapper"),f=!1,w=new Image,E=new Image;function b([e,t,n]){let r=y();for(var o=0;o<r.data.length;o+=4){let a=r.data[o],c=r.data[o+1],i=r.data[o+2],d=(r.data[o+3],(a+c+i)/3/255);r.data[o]=e*d,r.data[o+1]=t*d,r.data[o+2]=n*d}s.putImageData(r,0,0)}function y(){return s.clearRect(0,0,u,g),s.drawImage(E,0,0,u,g),s.getImageData(0,0,u,g)}function p(){for(var a=function(){l.drawImage(v,0,0,e,t);var n=.1*e,r=.1*t,o=e/2-n/2,a=t/2-r/2;return l.getImageData(o+5,a+5,n-5,r-5)}(),c={red:[],green:[],blue:[]},i=0;i<a.data.length;i+=4){let e=a.data[i],t=a.data[i+1],n=a.data[i+2];c.red.push(e),c.green.push(t),c.blue.push(n)}let d=c.red.length;var s,u,g;n=c.red.reduce((e,t)=>e+t)/d,r=c.green.reduce((e,t)=>e+t)/d,o=c.blue.reduce((e,t)=>e+t)/d,s=n,u=r,g=o,document.querySelector(".js-set-color").style.backgroundColor="rgb("+s+","+u+","+g+")"}function I(){if(p(),!f)return null;requestAnimationFrame(I)}w.src="/img/@2x/209.jpg",E.src="/img/@2x/209.png",a.width=u,a.height=g,c.width=u,c.height=g,w.onload=function(){d.drawImage(w,0,0,u,g)},E.onload=function(){y()},window.addEventListener("resize",function(){u=window.innerWidth,g=window.innerHeight,a.width=u,a.height=g,c.width=u,c.height=g,d.clearRect(0,0,u,g),d.drawImage(w,0,0,u,g),y()}),document.getElementById("color").addEventListener("change",function(e){var t=e.target.value.match(/[A-Za-z0-9]{2}/g);b(t=t.map(function(e){return parseInt(e,16)}))}),e=m.clientWidth,t=m.clientHeight,i.width=e,i.height=t,I(),document.querySelector(".js-capture").addEventListener("click",()=>{b([n,r,o]),document.querySelector(".js-open-video").style.backgroundColor="rgb("+n+","+r+","+o+")"}),document.querySelector(".js-close-video").addEventListener("click",e=>{e.preventDefault(),f=!1,h.classList.remove("isOpened")}),document.querySelector(".js-open-video").addEventListener("click",e=>{e.preventDefault(),f=!0,I(),h.classList.add("isOpened")})});const videoElement=document.querySelector("video"),videoSelect=document.querySelector("select#videoSource"),selectors=[videoSelect];function gotDevices(e){const t=selectors.map(e=>e.value);selectors.forEach(e=>{for(;e.firstChild;)e.removeChild(e.firstChild)});for(let t=0;t!==e.length;++t){const n=e[t],r=document.createElement("option");r.value=n.deviceId,"videoinput"===n.kind?(r.text=n.label||`camera ${videoSelect.length+1}`,videoSelect.appendChild(r)):console.log("Some other kind of source/device: ",n)}selectors.forEach((e,n)=>{Array.prototype.slice.call(e.childNodes).some(e=>e.value===t[n])&&(e.value=t[n])})}function gotStream(e){return window.stream=e,videoElement.srcObject=e,navigator.mediaDevices.enumerateDevices()}function handleError(e){console.log("navigator.MediaDevices.getUserMedia error: ",e.message,e.name)}function start(){window.stream&&window.stream.getTracks().forEach(e=>{e.stop()});const e=videoSelect.value,t={video:{deviceId:e?{exact:e}:void 0}};navigator.mediaDevices.getUserMedia(t).then(gotStream).then(gotDevices).catch(handleError)}navigator.mediaDevices.enumerateDevices().then(gotDevices).catch(handleError),videoSelect.onchange=start,start();